<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quiz Tarot ‚Äî R√¥le d‚Äô√©quipe</title>
  <style>
    :root{
      --bg:#0b0c10;
      --card:#11131a;
      --muted:#9aa3b2;
      --text:#e9edf5;
      --accent:#7c5cff;
      --accent2:#2ee59d;
      --danger:#ff5c7a;
      --border:rgba(255,255,255,.10);
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius: 18px;
    }
    *{ box-sizing: border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 20% 10%, rgba(124,92,255,.20), transparent 60%),
                  radial-gradient(900px 500px at 90% 30%, rgba(46,229,157,.16), transparent 55%),
                  var(--bg);
      color: var(--text);
      min-height: 100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 22px;
    }
    .app{
      width: min(920px, 100%);
      display:grid;
      gap: 16px;
    }
    .header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap: 12px;
    }
    .title{
      margin:0;
      font-size: clamp(22px, 3vw, 30px);
      letter-spacing: .2px;
    }
    .subtitle{
      margin: 6px 0 0 0;
      color: var(--muted);
      line-height: 1.35;
      max-width: 62ch;
      font-size: 14px;
    }
    .pill{
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      padding: 10px 12px;
      border-radius: 999px;
      color: var(--muted);
      font-size: 13px;
      white-space: nowrap;
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardInner{ padding: 18px; }
    .row{ display:flex; gap: 14px; align-items:center; flex-wrap:wrap; }
    .progressWrap{
      width: 100%;
      background: rgba(255,255,255,.05);
      border: 1px solid var(--border);
      border-radius: 999px;
      overflow:hidden;
      height: 10px;
    }
    .progressBar{
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      transition: width .25s ease;
    }
    .qMeta{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-top: 10px;
      color: var(--muted);
      font-size: 13px;
    }
    .qTitle{
      margin: 14px 0 12px 0;
      font-size: 18px;
      line-height: 1.35;
    }
    .answers{
      display:grid;
      gap: 10px;
      margin-top: 10px;
    }
    .answerBtn{
      text-align:left;
      width: 100%;
      border-radius: 14px;
      padding: 12px 12px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
      color: var(--text);
      cursor:pointer;
      transition: transform .06s ease, background .15s ease, border-color .15s ease;
      display:flex;
      gap: 10px;
      align-items:flex-start;
    }
    .answerBtn:hover{
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.18);
    }
    .answerBtn:active{ transform: translateY(1px); }
    .answerBtn.selected{
      border-color: rgba(124,92,255,.65);
      background: rgba(124,92,255,.14);
    }
    .answerKey{
      width: 24px; height: 24px;
      display:grid; place-items:center;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--muted);
      font-size: 12px;
      flex: 0 0 auto;
      margin-top: 1px;
    }
    .answerText{ line-height: 1.35; }
    .controls{
      margin-top: 14px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .btn{
      border-radius: 14px;
      padding: 10px 12px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--text);
      cursor:pointer;
      transition: transform .06s ease, background .15s ease, border-color .15s ease;
      font-weight: 600;
      letter-spacing: .2px;
    }
    .btn:hover{ background: rgba(255,255,255,.07); border-color: rgba(255,255,255,.18); }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      background: linear-gradient(90deg, rgba(124,92,255,.95), rgba(46,229,157,.85));
      border: 0;
      color: #0b0c10;
    }
    .btn.danger{
      background: rgba(255,92,122,.12);
      border-color: rgba(255,92,122,.35);
      color: #ffd7de;
    }
    .btn:disabled{
      opacity:.5; cursor:not-allowed;
    }
    .hint{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }
    .grid2{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }
    @media (min-width: 860px){
      .grid2{ grid-template-columns: 1.2fr .8fr; align-items: start; }
    }
    .resultBox{
      border-radius: 18px;
      border: 1px solid var(--border);
      background: rgba(0,0,0,.25);
      padding: 14px;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      border-radius: 999px;
      padding: 8px 10px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.10);
      color: var(--text);
      font-weight: 700;
      font-size: 13px;
    }
    .badge small{ color: var(--muted); font-weight: 600; }
    .resultTitle{
      margin: 12px 0 6px 0;
      font-size: 20px;
      line-height: 1.25;
    }
    .resultText{
      margin: 0;
      color: var(--muted);
      line-height: 1.55;
      font-size: 14px;
    }
    .mini{
      margin-top: 10px;
      display:grid;
      gap: 8px;
    }
    .miniItem{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      padding: 10px 10px;
      border-radius: 14px;
      background: rgba(255,255,255,.03);
      border: 1px solid rgba(255,255,255,.09);
      font-size: 13px;
      color: var(--muted);
    }
    .miniItem b{ color: var(--text); }
    .footerNote{
      margin-top: 10px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.45;
    }
    .toast{
      position: fixed;
      bottom: 18px; left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,.75);
      border: 1px solid rgba(255,255,255,.12);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 13px;
      box-shadow: var(--shadow);
      opacity: 0;
      pointer-events:none;
      transition: opacity .2s ease, transform .2s ease;
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-6px);
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="header">
      <div>
        <h1 class="title">Quiz Tarot ‚Äî R√¥le d‚Äô√©quipe</h1>
        <p class="subtitle">
          Mini-jeu symbolique (pas de psy, pas de ‚Äúbon/mauvais‚Äù). √Ä la fin : <b>1 r√¥le dominant</b> + <b>2 dynamiques</b> qui d√©crivent ‚Äúcomment tu joues ton r√¥le‚Äù.
        </p>
      </div>
      <div class="pill" id="modePill">16 questions ‚Ä¢ ~5 min</div>
    </div>

    <div class="card">
      <div class="cardInner grid2">
        <div>
          <div class="progressWrap" aria-label="progression">
            <div class="progressBar" id="progressBar"></div>
          </div>
          <div class="qMeta">
            <div id="qCounter">Question 1/16</div>
            <div id="qType">R√¥le</div>
          </div>

          <h2 class="qTitle" id="qTitle">...</h2>

          <div class="answers" id="answers"></div>

          <div class="controls">
            <button class="btn" id="backBtn">‚Üê Retour</button>
            <div style="display:flex; gap:10px; flex-wrap:wrap;">
              <button class="btn danger" id="resetBtn" title="Effacer toutes les r√©ponses">Reset</button>
              <button class="btn primary" id="nextBtn" disabled>Suivant ‚Üí</button>
            </div>
          </div>

          <p class="hint" id="hint">
            Astuce : r√©ponds instinctivement. Tu peux revenir en arri√®re √† tout moment.
          </p>
        </div>

        <div>
          <div class="resultBox" id="resultBox" style="display:none;">
            <div class="row">
              <span class="badge" id="roleBadge">üé≠ R√¥le</span>
              <span class="badge" id="dynBadge">üîÑ Dynamiques</span>
            </div>

            <h3 class="resultTitle" id="resultTitle">Ton r√©sultat</h3>
            <p class="resultText" id="resultText"></p>

            <div class="mini" id="miniScores"></div>

            <div class="controls" style="margin-top: 12px;">
              <button class="btn" id="copyBtn">Copier le r√©sultat</button>
              <button class="btn primary" id="againBtn">Recommencer</button>
            </div>

            <div class="footerNote">
              Note : ce quiz vise une discussion l√©g√®re (‚Äúr√¥le naturel en √©quipe‚Äù), pas une v√©rit√© absolue.
            </div>
          </div>

          <div class="resultBox" id="sideBox">
            <div class="miniItem"><b>R√¥les</b><span>8</span></div>
            <div class="miniItem"><b>Dynamiques</b><span>4 (tu en as 2)</span></div>
            <div class="miniItem"><b>Mode</b><span>Dominant + 2 secondaires</span></div>
            <div class="footerNote">
              Tu pourras ensuite associer chaque carte √† une petite description (2‚Äì3 lignes) et/ou une image libre de droits.
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <div class="toast" id="toast">Copi√© ‚úÖ</div>

  <script>
    // --- Mod√®le fig√© ---
    const ROLES = [
      { id: "bateleur", name: "Le Bateleur", emoji: "ü™Ñ", role: "L‚ÄôInitiateur" },
      { id: "papesse", name: "La Papesse", emoji: "üìö", role: "L‚ÄôAnalyste" },
      { id: "imperatrice", name: "L‚ÄôImp√©ratrice", emoji: "üé®", role: "Le Cr√©atif" },
      { id: "empereur", name: "L‚ÄôEmpereur", emoji: "üèõÔ∏è", role: "Le Cadreur" },
      { id: "amoureux", name: "L‚ÄôAmoureux", emoji: "ü§ù", role: "Le Connecteur" },
      { id: "chariot", name: "Le Chariot", emoji: "üèÅ", role: "Le Moteur" },
      { id: "hermite", name: "L‚ÄôHermite", emoji: "üî¶", role: "Le R√©f√©rent" },
      { id: "soleil", name: "Le Soleil", emoji: "‚òÄÔ∏è", role: "Le F√©d√©rateur" },
    ];

    const DYNAMICS = [
      { id: "fou", name: "Le Fou", emoji: "üÉè", dyn: "Hors cadre / intuitif" },
      { id: "force", name: "La Force", emoji: "ü¶Å", dyn: "Ma√Ætrise / calme" },
      { id: "roue", name: "La Roue", emoji: "üé°", dyn: "Adaptation / opportunit√©" },
      { id: "temperance", name: "Temp√©rance", emoji: "‚öóÔ∏è", dyn: "√âquilibre / facilitateur" },
    ];

    // 16 questions :
    // - 12 orient√©es "R√¥le" (r√©parties pour scorer correctement les 8)
    // - 4 orient√©es "Dynamique" (2 apparitions chacune)
    const QUESTIONS = [
      // R√¥les (1)
      {
        type: "role",
        title: "Dans une √©quipe, tu es naturellement celui/celle qui‚Ä¶",
        answers: [
          { label: "‚Ä¶ lance les choses et d√©bloque le d√©marrage.", tag: "bateleur" },
          { label: "‚Ä¶ observe, comprend, et pose les bonnes questions.", tag: "papesse" },
          { label: "‚Ä¶ relie les gens et facilite la coop√©ration.", tag: "amoureux" },
          { label: "‚Ä¶ met de l‚Äô√©nergie et entra√Æne le groupe.", tag: "soleil" },
        ],
      },
      // R√¥les (2)
      {
        type: "role",
        title: "Quand un sujet est flou, tu pr√©f√®res‚Ä¶",
        answers: [
          { label: "‚Ä¶ tester vite une option pour apprendre.", tag: "bateleur" },
          { label: "‚Ä¶ cadrer la d√©cision et poser des r√®gles du jeu.", tag: "empereur" },
          { label: "‚Ä¶ reformuler avec une m√©taphore / un angle cr√©atif.", tag: "imperatrice" },
          { label: "‚Ä¶ clarifier les objectifs et pousser √† l‚Äôaction.", tag: "chariot" },
        ],
      },
      // Dynamique (1)
      {
        type: "dyn",
        title: "Face √† l‚Äôimpr√©vu, ton r√©flexe est plut√¥t‚Ä¶",
        answers: [
          { label: "‚Ä¶ l‚Äôintuition et l‚Äôimpro (on verra en marchant).", tag: "fou" },
          { label: "‚Ä¶ rester calme et tenir le cap.", tag: "force" },
          { label: "‚Ä¶ rebondir vite et profiter du timing.", tag: "roue" },
          { label: "‚Ä¶ chercher un compromis fluide.", tag: "temperance" },
        ],
      },
      // R√¥les (3)
      {
        type: "role",
        title: "Ce que tu aimes le plus apporter au travail :",
        answers: [
          { label: "Une structure claire et des d√©cisions nettes.", tag: "empereur" },
          { label: "Des id√©es, du style, une narration qui parle.", tag: "imperatrice" },
          { label: "Un regard lucide, du recul, du sens.", tag: "hermite" },
          { label: "Une dynamique pour atteindre l‚Äôobjectif.", tag: "chariot" },
        ],
      },
      // R√¥les (4)
      {
        type: "role",
        title: "En r√©union, on peut compter sur toi pour‚Ä¶",
        answers: [
          { label: "‚Ä¶ donner une direction et prioriser.", tag: "empereur" },
          { label: "‚Ä¶ poser une question qui change la perspective.", tag: "papesse" },
          { label: "‚Ä¶ faire √©merger un consensus.", tag: "amoureux" },
          { label: "‚Ä¶ relancer l‚Äô√©nergie et garder l‚Äô√©lan.", tag: "soleil" },
        ],
      },
      // R√¥les (5)
      {
        type: "role",
        title: "Quand √ßa bloque, tu as tendance √†‚Ä¶",
        answers: [
          { label: "‚Ä¶ tenter une approche nouvelle / un prototype.", tag: "bateleur" },
          { label: "‚Ä¶ analyser ce qui manque et remonter aux causes.", tag: "papesse" },
          { label: "‚Ä¶ cr√©er une alternative plus simple et expressive.", tag: "imperatrice" },
          { label: "‚Ä¶ prendre la d√©cision qui permet d‚Äôavancer.", tag: "empereur" },
        ],
      },
      // Dynamique (2)
      {
        type: "dyn",
        title: "Ton style d‚Äôaction ‚Äúpar d√©faut‚Äù ressemble plut√¥t √†‚Ä¶",
        answers: [
          { label: "Spontan√© : je saute dans l‚Äôinconnu.", tag: "fou" },
          { label: "Stable : je garde le contr√¥le √©motionnel.", tag: "force" },
          { label: "Agile : je pivote selon la situation.", tag: "roue" },
          { label: "Harmonisant : j‚Äô√©quilibre les tensions.", tag: "temperance" },
        ],
      },
      // R√¥les (6)
      {
        type: "role",
        title: "Dans un projet, tu pr√©f√®res √™tre reconnu(e) pour‚Ä¶",
        answers: [
          { label: "Avoir initi√© et mis en route.", tag: "bateleur" },
          { label: "Avoir compris le fond et s√©curis√© le raisonnement.", tag: "papesse" },
          { label: "Avoir renforc√© les liens et la coop√©ration.", tag: "amoureux" },
          { label: "Avoir port√© l‚Äô√©quipe jusqu‚Äôau r√©sultat.", tag: "chariot" },
        ],
      },
      // R√¥les (7)
      {
        type: "role",
        title: "Quand tu dois apprendre quelque chose de nouveau, tu‚Ä¶",
        answers: [
          { label: "‚Ä¶ exp√©rimentes tout de suite.", tag: "bateleur" },
          { label: "‚Ä¶ lis/creuses en profondeur.", tag: "papesse" },
          { label: "‚Ä¶ demandes un point de vue expert / du recul.", tag: "hermite" },
          { label: "‚Ä¶ fais un plan et tu suis une m√©thode.", tag: "empereur" },
        ],
      },
      // R√¥les (8)
      {
        type: "role",
        title: "Ce qui te ressemble le plus au quotidien :",
        answers: [
          { label: "Je stimule l‚Äôambiance et la coh√©sion.", tag: "soleil" },
          { label: "Je donne du sens et j‚Äôaide √† prendre du recul.", tag: "hermite" },
          { label: "Je transforme des id√©es en messages clairs.", tag: "imperatrice" },
          { label: "Je fais avancer le plan et les objectifs.", tag: "chariot" },
        ],
      },
      // Dynamique (3)
      {
        type: "dyn",
        title: "Si on devait d√©crire ton √©nergie en 1 mot :",
        answers: [
          { label: "Libre", tag: "fou" },
          { label: "Solide", tag: "force" },
          { label: "Souple", tag: "roue" },
          { label: "Fluide", tag: "temperance" },
        ],
      },
      // R√¥les (9)
      {
        type: "role",
        title: "Dans un moment de tension dans l‚Äô√©quipe, tu‚Ä¶",
        answers: [
          { label: "‚Ä¶ recadres et clarifies le cadre.", tag: "empereur" },
          { label: "‚Ä¶ fais baisser la pression en cr√©ant du lien.", tag: "amoureux" },
          { label: "‚Ä¶ apportes une √©nergie positive au groupe.", tag: "soleil" },
          { label: "‚Ä¶ prends du recul pour remettre du sens.", tag: "hermite" },
        ],
      },
      // R√¥les (10)
      {
        type: "role",
        title: "Ton r√¥le ‚Äúid√©al‚Äù dans une √©quipe ressemble plut√¥t √†‚Ä¶",
        answers: [
          { label: "L‚Äôinitiateur qui lance et explore.", tag: "bateleur" },
          { label: "La personne qui s√©curise le raisonnement.", tag: "papesse" },
          { label: "Le/la cr√©atif(ve) qui donne une forme aux id√©es.", tag: "imperatrice" },
          { label: "Le moteur qui pousse au r√©sultat.", tag: "chariot" },
        ],
      },
      // Dynamique (4)
      {
        type: "dyn",
        title: "Quand tu collabores, tu pr√©f√®res un style‚Ä¶",
        answers: [
          { label: "Improvis√© : on s‚Äôadapte en temps r√©el.", tag: "fou" },
          { label: "Pos√© : on reste calme et constant.", tag: "force" },
          { label: "√âvolutif : on change de plan si besoin.", tag: "roue" },
          { label: "M√©diateur : on cherche l‚Äô√©quilibre.", tag: "temperance" },
        ],
      },
      // R√¥les (11)
      {
        type: "role",
        title: "Si tu devais choisir une priorit√©, ce serait‚Ä¶",
        answers: [
          { label: "Comprendre avant d‚Äôagir.", tag: "papesse" },
          { label: "Mettre de l‚Äôordre et rendre √ßa clair.", tag: "empereur" },
          { label: "Cr√©er une bonne dynamique relationnelle.", tag: "amoureux" },
          { label: "Partager de l‚Äô√©nergie et f√©d√©rer.", tag: "soleil" },
        ],
      },
      // R√¥les (12)
      {
        type: "role",
        title: "Quand tout va bien, on te voit plut√¥t comme‚Ä¶",
        answers: [
          { label: "Celui/celle qui ouvre des portes et tente.", tag: "bateleur" },
          { label: "Celui/celle qui comprend et √©claire.", tag: "papesse" },
          { label: "Celui/celle qui inspire et donne une forme.", tag: "imperatrice" },
          { label: "Celui/celle qui cr√©e de la chaleur collective.", tag: "soleil" },
        ],
      },
    ];

    // --- Descriptions (provisoires, on les peaufinera ensuite ensemble) ---
    const ROLE_DESC = {
      bateleur: "Tu lances, tu testes, tu d√©bloques. Tu es √† l‚Äôaise dans les d√©buts et l‚Äôexploration.",
      papesse: "Tu observes, tu comprends, tu poses les bonnes questions. Tu renforces la qualit√© des d√©cisions.",
      imperatrice: "Tu donnes une forme aux id√©es : cr√©ativit√©, communication, clart√©. Tu rends l‚Äôabstrait concret.",
      empereur: "Tu structures, tu cadres, tu s√©curises. Tu es utile quand il faut d√©cider et organiser.",
      amoureux: "Tu connectes les personnes et tu facilites la coop√©ration. Tu fluidifies les √©changes.",
      chariot: "Tu mets de l‚Äô√©lan et tu pousses au r√©sultat. Tu transformes les intentions en avanc√©es concr√®tes.",
      hermite: "Tu apportes du recul, de la lucidit√©, du sens. Tu aides l‚Äô√©quipe √† choisir la bonne direction.",
      soleil: "Tu f√©d√®res, tu motives, tu cr√©es une √©nergie collective positive. Tu renforces la coh√©sion.",
    };

    const DYN_DESC = {
      fou: "Mode ‚Äúlibre‚Äù : intuition, spontan√©it√©, hors cadre (dans le bon sens).",
      force: "Mode ‚Äúsolide‚Äù : calme, ma√Ætrise, constance, fiabilit√©.",
      roue: "Mode ‚Äúagile‚Äù : adaptation, opportunisme, pivot rapide.",
      temperance: "Mode ‚Äúfluide‚Äù : m√©diation, √©quilibre, facilitation naturelle.",
    };

    // --- State ---
    const state = {
      index: 0,
      answers: Array(QUESTIONS.length).fill(null), // stores selected answer index per question
    };

    // --- Elements ---
    const progressBar = document.getElementById("progressBar");
    const qCounter = document.getElementById("qCounter");
    const qType = document.getElementById("qType");
    const qTitle = document.getElementById("qTitle");
    const answersEl = document.getElementById("answers");
    const backBtn = document.getElementById("backBtn");
    const nextBtn = document.getElementById("nextBtn");
    const resetBtn = document.getElementById("resetBtn");

    const resultBox = document.getElementById("resultBox");
    const sideBox = document.getElementById("sideBox");
    const roleBadge = document.getElementById("roleBadge");
    const dynBadge = document.getElementById("dynBadge");
    const resultTitle = document.getElementById("resultTitle");
    const resultText = document.getElementById("resultText");
    const miniScores = document.getElementById("miniScores");
    const copyBtn = document.getElementById("copyBtn");
    const againBtn = document.getElementById("againBtn");
    const toast = document.getElementById("toast");

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(()=>toast.classList.remove("show"), 1100);
    }

    function setIndex(i){
      state.index = Math.max(0, Math.min(i, QUESTIONS.length)); // allow == length for result
      render();
    }

    function render(){
      const isResult = state.index >= QUESTIONS.length;

      // Toggle views
      if(isResult){
        resultBox.style.display = "block";
        sideBox.style.display = "none";
        // Hide question UI bits
        document.getElementById("hint").style.display = "none";
        backBtn.textContent = "‚Üê Revoir";
        nextBtn.style.display = "none";
        renderResult();
        // progress full
        progressBar.style.width = "100%";
        qCounter.textContent = "R√©sultat";
        qType.textContent = "üé¥";
        qTitle.textContent = "Ton r√¥le + dynamiques";
        answersEl.innerHTML = "";
        return;
      } else {
        resultBox.style.display = "none";
        sideBox.style.display = "block";
        document.getElementById("hint").style.display = "block";
        backBtn.textContent = "‚Üê Retour";
        nextBtn.style.display = "inline-block";
      }

      const q = QUESTIONS[state.index];
      const answered = state.answers[state.index] !== null;

      // Progress
      const pct = Math.round((state.index / QUESTIONS.length) * 100);
      progressBar.style.width = pct + "%";

      qCounter.textContent = `Question ${state.index + 1}/${QUESTIONS.length}`;
      qType.textContent = (q.type === "role") ? "R√¥le (dominant)" : "Dynamique (secondaire)";
      qTitle.textContent = q.title;

      // Answers
      answersEl.innerHTML = "";
      q.answers.forEach((a, idx)=>{
        const btn = document.createElement("button");
        btn.className = "answerBtn" + (state.answers[state.index] === idx ? " selected" : "");
        btn.type = "button";
        btn.innerHTML = `
          <div class="answerKey">${String.fromCharCode(65+idx)}</div>
          <div class="answerText">${a.label}</div>
        `;
        btn.addEventListener("click", ()=>{
          state.answers[state.index] = idx;
          render();
        });
        answersEl.appendChild(btn);
      });

      nextBtn.disabled = !answered;
      backBtn.disabled = state.index === 0;
    }

    function computeScores(){
      const roleScores = Object.fromEntries(ROLES.map(r => [r.id, 0]));
      const dynScores  = Object.fromEntries(DYNAMICS.map(d => [d.id, 0]));

      for(let i=0;i<QUESTIONS.length;i++){
        const sel = state.answers[i];
        if(sel === null) continue;
        const q = QUESTIONS[i];
        const tag = q.answers[sel].tag;

        if(q.type === "role") roleScores[tag] += 1;
        else dynScores[tag] += 1;
      }

      return { roleScores, dynScores };
    }

    function topKeys(scoreObj, n){
      const entries = Object.entries(scoreObj);
      entries.sort((a,b)=> b[1]-a[1] || a[0].localeCompare(b[0]));
      return entries.slice(0,n);
    }

    function renderResult(){
      const { roleScores, dynScores } = computeScores();

      // role dominant
      const [roleId, roleVal] = topKeys(roleScores, 1)[0];
      const roleMeta = ROLES.find(r=>r.id===roleId);

      // 2 dynamiques (top2)
      const dynTop = topKeys(dynScores, 2);
      const dyn1 = DYNAMICS.find(d=>d.id===dynTop[0][0]);
      const dyn2 = DYNAMICS.find(d=>d.id===dynTop[1][0]);

      roleBadge.textContent = `${roleMeta.emoji} ${roleMeta.name} ‚Ä¢ ${roleMeta.role}`;
      dynBadge.textContent  = `${dyn1.emoji} ${dyn1.name} + ${dyn2.emoji} ${dyn2.name}`;

      resultTitle.textContent = `${roleMeta.role} ‚Äî ${roleMeta.name}`;
      resultText.textContent =
        `${ROLE_DESC[roleId]} ` +
        `\n\nDynamiques : ${dyn1.name} (${DYN_DESC[dyn1.id]}) + ${dyn2.name} (${DYN_DESC[dyn2.id]})`;

      // small score panel
      miniScores.innerHTML = "";
      const roleLine = document.createElement("div");
      roleLine.className = "miniItem";
      roleLine.innerHTML = `<span>Score r√¥le dominant</span><b>${roleVal}</b>`;
      miniScores.appendChild(roleLine);

      const dynLine = document.createElement("div");
      dynLine.className = "miniItem";
      dynLine.innerHTML = `<span>Scores dynamiques</span><b>${dynTop[0][1]} / ${dynTop[1][1]}</b>`;
      miniScores.appendChild(dynLine);

      const hintLine = document.createElement("div");
      hintLine.className = "miniItem";
      hintLine.innerHTML = `<span>Tip</span><b>Comparez vos r√¥les autour du repas üòÑ</b>`;
      miniScores.appendChild(hintLine);

      // store text for copy
      const shareText =
`üé¥ R√©sultat du quiz (Tarot ‚Äì r√¥les d‚Äô√©quipe)
R√¥le dominant : ${roleMeta.role} ‚Äî ${roleMeta.name}
Dynamiques : ${dyn1.name} + ${dyn2.name}
R√©sum√© : ${ROLE_DESC[roleId]}
`;
      copyBtn.onclick = async () => {
        try{
          await navigator.clipboard.writeText(shareText);
          showToast("Copi√© ‚úÖ");
        } catch(e){
          // fallback
          const ta = document.createElement("textarea");
          ta.value = shareText;
          document.body.appendChild(ta);
          ta.select();
          document.execCommand("copy");
          document.body.removeChild(ta);
          showToast("Copi√© ‚úÖ");
        }
      };
    }

    function allAnswered(){
      return state.answers.every(a => a !== null);
    }

    // Controls
    nextBtn.addEventListener("click", ()=>{
      if(state.index < QUESTIONS.length-1){
        setIndex(state.index + 1);
      } else {
        // last question -> result
        if(allAnswered()) setIndex(QUESTIONS.length);
      }
    });

    backBtn.addEventListener("click", ()=>{
      if(state.index >= QUESTIONS.length){
        // from result, go back to last question
        setIndex(QUESTIONS.length - 1);
      } else {
        setIndex(state.index - 1);
      }
    });

    resetBtn.addEventListener("click", ()=>{
      if(!confirm("Reset : effacer toutes les r√©ponses ?")) return;
      state.answers = Array(QUESTIONS.length).fill(null);
      setIndex(0);
      showToast("Reset ‚úÖ");
    });

    againBtn.addEventListener("click", ()=>{
      state.answers = Array(QUESTIONS.length).fill(null);
      setIndex(0);
    });

    // On load: render
    render();
  </script>
</body>
</html>
